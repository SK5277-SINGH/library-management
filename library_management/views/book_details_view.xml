<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<data>
		<record id="view_book_search" model="ir.ui.view">
	        <field name="name">book.search</field>
	        <field name="model">product.template</field>
	        <field name="arch" type="xml">
	            <search string="Book Search">
	                <filter string="All Books" name="book" domain="[('role_librarian', '=','True')]"/>
	                <filter string="Available" name="" domain="[('state', '=','avail')]"/>
	                <filter string="Not Available" name="" domain="[('state', '=','not_avail')]"/>
	                <separator/>
	                <group expand="1" string="Group By">
	                    <filter string="Atuhor" name="author" context="{'group_by':'author'}"/>
	                    <filter string="Publisher" name="publisher" context="{'group_by':'publisher'}"/>
	                </group>
	            </search>
	        </field>
	    </record>

		<record id="view_book_details" model="ir.ui.view">
			<field name="name">view.book.details</field>
			<field name="model">product.template</field>
			<field name="inherit_id" ref="product.product_template_only_form_view"/>
			<field name="arch" type="xml">
				<header>
	                <button name="state_book_avail" type="object" string="Available" 
	                    	class="oe_highlight" attrs="{ 
	                    	'invisible':[
	                    				'|',('state','=','not_avail'),'|',('state','=','avail'),'|',('role_librarian','=',False)
	                    				]}"/>
					<field name="state"  widget="statusbar"/>
				</header>
				<!-- Librarian -->
				<xpath expr="//label[@for='name']" position="before">
					<div groups='library_management.library_group_librarian'>
						<field name="role_librarian"  widget="checkbox"/>
						<label for='Librarian' string='Librarian'/>
					</div>
				</xpath>
				<!-- book type -->
				<xpath expr="//field[@name='name']" position="after">
					<div>
						<label for='book_type' string="Book Type:"/>
						<field name="book_type" widget='many2many_tags' 
							   attrs="{'invisible':[('role_librarian', '=' ,False)]}"/>
					</div>
						
				</xpath>

				<xpath expr="//field[@name='type']" position="after">
					<field name="isbn" attrs="{
						'invisible':[('role_librarian', '=' ,False)],
						'required':[('role_librarian','=',True)]}"/>

					<field name="language" 
						   widget='many2many_tags' 
						   attrs="{
						   			'invisible':[('role_librarian', '=' ,False)]}"/>					
				</xpath>

				<xpath expr="//field[@name='standard_price']" position="replace">
						<field name="standard_price" required='1'/>
				</xpath>

				<xpath expr="//field[@name='list_price']" position="replace">
					<field name="copies" attrs="{
						'invisible':[('role_librarian', '=' ,False)],
						'required': [('role_librarian', '=' ,True)]}"/>
				</xpath>

				<xpath expr="//field[@name='copies']" position="after">
					<field name="date" attrs="{'invisible':[('role_librarian', '=' ,False)]}"/>
					<field name="author" attrs="{'invisible':[('role_librarian', '=' ,False)]}"/>
					<field name="publisher" attrs="{'invisible':[('role_librarian', '=' ,False)]}"/>
					<field name="description" attrs="{'invisible':[('role_librarian', '=' ,False)]}"/>

					<field name="book_avail" force_save="1" attrs="{
						'invisible':[('role_librarian', '=' ,False)],
						'readonly':[('role_librarian', '=' ,True)]
						}"/>
				</xpath>								

				<xpath expr="//page[@name='variants']/field[@name='attribute_line_ids']/tree/field[@name='value_ids']" position="replace">
					<field name="qty"/>
				</xpath>
				
			</field>
		</record>
	</data>
</odoo>
